# Switchboard Plus v2.0 - μ¤‘λ³µ ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰ λ°©μ§€ λ¬Έμ  ν•΄κ²° λ³΄κ³ μ„

## 1. λ¬Έμ  μƒν™©

### 1.1 μ΄κΈ° λ¬Έμ μ 
- **κ°™μ€ μ»΄ν“¨ν„°μ—μ„ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰**ν•  λ• λ°μƒν•λ” λ¬Έμ 
- **μ¤‘λ³µ ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μ‹λ„**λ΅ μΈν• κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈ μ—°κ²° λκΉ€
- **μ„λ²„μ μ†μΌ“ κ΄€λ¦¬ λ¬Έμ **λ΅ μΈν• μ „μ²΄ μ‹μ¤ν… λ¶μ•μ •

### 1.2 κµ¬μ²΄μ μΈ μ¦μƒ
1. **μ²« λ²μ§Έ ν΄λΌμ΄μ–ΈνΈ**: μ •μƒμ μΌλ΅ μ—°κ²°λμ–΄ ν•νΈλΉ„νΈ μ „μ†΅
2. **λ‘ λ²μ§Έ ν΄λΌμ΄μ–ΈνΈ**: κ°™μ€ μ΄λ¦„μΌλ΅ μ—°κ²° μ‹λ„
3. **μ„λ²„**: μ¤‘λ³µ μ—°κ²° κ±°λ¶€ μ²λ¦¬
4. **κ²°κ³Ό**: μ²« λ²μ§Έ ν΄λΌμ΄μ–ΈνΈλ„ μ—°κ²°μ΄ λμ–΄μ§
5. **μ„λ²„ λ΅κ·Έ**: "ν™•μΈν•  μ¨λΌμΈ ν΄λΌμ΄μ–ΈνΈ: 0κ°"λ΅ λ³€κ²½

## 2. λ¬Έμ  λ¶„μ„ κ³Όμ •

### 2.1 μ²« λ²μ§Έ μ‹λ„: μ„λ²„ μΈ΅ μ¤‘λ³µ μ—°κ²° μ²λ¦¬ κ°μ„ 
**λ¬Έμ **: μ„λ²„μ—μ„ μ¤‘λ³µ μ—°κ²°μ„ κ±°λ¶€ν•  λ• κΈ°μ΅΄ μ†μΌ“κΉμ§€ μ κ±°ν•λ” λ¬Έμ 

**μ‹λ„ν• ν•΄κ²°μ±…**:
```javascript
// κΈ°μ΅΄ μ†μΌ“μ΄ μμΌλ©΄ μ κ±°
if (existingClient.name && connectedClients.has(existingClient.name)) {
  connectedClients.delete(existingClient.name);
  console.log(`π—‘οΈ κΈ°μ΅΄ μ†μΌ“ μ •λ³΄ μ κ±°: ${existingClient.name}`);
}
```

**κ²°κ³Ό**: β μ‹¤ν¨ - μ—¬μ „ν κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ΄ λμ–΄μ§

### 2.2 λ‘ λ²μ§Έ μ‹λ„: disconnect μ΄λ²¤νΈ μ²λ¦¬ κ°μ„ 
**λ¬Έμ **: disconnect μ΄λ²¤νΈμ—μ„ μ†μΌ“μ„ μ κ±°ν•  λ• λ‹¤λ¥Έ μ†μΌ“μ— μν–¥μ„ μ£Όλ” λ¬Έμ 

**μ‹λ„ν• ν•΄κ²°μ±…**:
```javascript
socket.on('disconnect', () => {
  // ν„μ¬ μ†μΌ“μ΄ μ‹¤μ λ΅ μ—°κ²°μ΄ λμ–΄μ§„ μ†μΌ“μΈμ§€ ν™•μΈ
  const currentSocket = connectedClients.get(socket.clientName);
  if (currentSocket && currentSocket.id === socket.id) {
    connectedClients.delete(socket.clientName);
    console.log(`π—‘οΈ ν΄λΌμ΄μ–ΈνΈ μ†μΌ“ μ κ±°: ${socket.clientName}`);
  } else {
    console.log(`β οΈ λ‹¤λ¥Έ μ†μΌ“μ΄ μ΄λ―Έ λ“±λ΅λμ–΄ μμ - μ†μΌ“ μ κ±° κ±΄λ„λ€: ${socket.clientName}`);
  }
});
```

**κ²°κ³Ό**: β μ‹¤ν¨ - μ—¬μ „ν κ°™μ€ λ¬Έμ  λ°μƒ

### 2.3 μ„Έ λ²μ§Έ μ‹λ„: μ†μΌ“ ν•΄μ  λ°©μ‹ λ³€κ²½
**λ¬Έμ **: `socket.disconnect()` νΈμ¶ μ‹ κ°™μ€ IPμ λ¨λ“  μ†μΌ“μ΄ μν–¥μ„ λ°›λ” λ¬Έμ 

**μ‹λ„ν• ν•΄κ²°μ±…**:
```javascript
// μ†μΌ“μ„ ν•΄μ ν•μ§€ μ•κ³  ν΄λΌμ΄μ–ΈνΈκ°€ μμ²΄μ μΌλ΅ μΆ…λ£ν•λ„λ΅ ν•¨
console.log(`β… μ¤‘λ³µ μ—°κ²° κ±°λ¶€ - ν΄λΌμ΄μ–ΈνΈ μμ²΄ μΆ…λ£ λ€κΈ°: ${name}`);
return;
```

**κ²°κ³Ό**: β μ‹¤ν¨ - ν΄λΌμ΄μ–ΈνΈκ°€ `registration_failed` μ΄λ²¤νΈλ¥Ό λ°›κΈ° μ „μ— disconnect μ΄λ²¤νΈ λ°μƒ

### 2.4 λ„¤ λ²μ§Έ μ‹λ„: ν¬νΈ κΈ°λ° μ¤‘λ³µ μ‹¤ν–‰ λ°©μ§€
**λ¬Έμ **: Socket.IO ν΄λΌμ΄μ–ΈνΈκ°€ λ³„λ„ ν¬νΈλ¥Ό μ‚¬μ©ν•λ―€λ΅ ν¬νΈ ν™•μΈμ΄ λ¬΄μλ―Έν•¨

**μ‹λ„ν• ν•΄κ²°μ±…**:
```python
def check_port_availability(self):
    """λ΅μ»¬ ν¬νΈ 8081μ΄ μ‚¬μ© κ°€λ¥ν•μ§€ ν™•μΈν•©λ‹λ‹¤."""
    try:
        test_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        test_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        test_socket.bind(('localhost', 8081))
        test_socket.close()
        return True
    except OSError:
        return False
```

**κ²°κ³Ό**: β μ‹¤ν¨ - Socket.IOλ” λ™μ  ν¬νΈλ¥Ό μ‚¬μ©ν•λ―€λ΅ ν¬νΈ ν™•μΈμ΄ μλ―Έ μ—†μ

## 3. μµμΆ… ν•΄κ²°μ±…: ν”„λ΅μ„Έμ¤ κΈ°λ° μ¤‘λ³µ μ‹¤ν–‰ λ°©μ§€

### 3.1 ν•΄κ²° λ°©λ²•
**ν”„λ΅μ„Έμ¤ ID κΈ°λ°μΌλ΅ κ°™μ€ μ΄λ¦„μ ν΄λΌμ΄μ–ΈνΈκ°€ μ΄λ―Έ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ**

### 3.2 κµ¬ν„ μ½”λ“

#### 3.2.1 ν΄λΌμ΄μ–ΈνΈ μΈ΅ κµ¬ν„
```python
import psutil

def check_duplicate_process(self):
    """κ°™μ€ μ΄λ¦„μ ν΄λΌμ΄μ–ΈνΈκ°€ μ΄λ―Έ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈν•©λ‹λ‹¤."""
    try:
        current_pid = os.getpid()
        for proc in psutil.process_iter(['pid', 'name', 'cmdline']):
            try:
                # ν„μ¬ ν”„λ΅μ„Έμ¤λ” μ μ™Έ
                if proc.info['pid'] == current_pid:
                    continue
                
                # Python ν”„λ΅μ„Έμ¤μΈμ§€ ν™•μΈ
                if proc.info['name'] and 'python' in proc.info['name'].lower():
                    cmdline = proc.info['cmdline']
                    if cmdline and len(cmdline) > 1:
                        # client.pyκ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ
                        if 'client.py' in cmdline[1] or 'start_client.bat' in ' '.join(cmdline):
                            print(f"β οΈ λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈ ν”„λ΅μ„Έμ¤ λ°κ²¬: PID {proc.info['pid']}")
                            return False
            except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
                continue
        return True
    except Exception as e:
        print(f"β οΈ ν”„λ΅μ„Έμ¤ ν™•μΈ μ¤‘ μ¤λ¥: {e}")
        return True  # μ¤λ¥ μ‹ μ‹¤ν–‰ ν—μ©
```

#### 3.2.2 ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹ μ μ©
```python
def __init__(self, server_url="http://localhost:8000", client_name=None):
    # ... κΈ°μ΅΄ μ½”λ“ ...
    
    # μ¤‘λ³µ μ‹¤ν–‰ λ°©μ§€λ¥Ό μ„ν• ν”„λ΅μ„Έμ¤ ν™•μΈ
    if not self.check_duplicate_process():
        print(f"β μ΄λ―Έ μ‹¤ν–‰ μ¤‘μΈ ν΄λΌμ΄μ–ΈνΈκ°€ μμµλ‹λ‹¤. (μ΄λ¦„: {self.client_name})")
        logging.error(f"μ΄λ―Έ μ‹¤ν–‰ μ¤‘μΈ ν΄λΌμ΄μ–ΈνΈκ°€ μμµλ‹λ‹¤. (μ΄λ¦„: {self.client_name})")
        sys.exit(1)
    
    # ... λ‚λ¨Έμ§€ μ½”λ“ ...
```

#### 3.2.3 μμ΅΄μ„± μ¶”κ°€
```txt
# requirements.txt
python-socketio==5.8.0
requests==2.31.0
psutil==5.9.5
```

### 3.3 μ„λ²„ μΈ΅ κ°μ„ μ‚¬ν•­
**μ¤‘λ³µ μ—°κ²° κ±°λ¶€ μ‹ μ†μΌ“μ„ ν•΄μ ν•μ§€ μ•κ³  ν΄λΌμ΄μ–ΈνΈκ°€ μμ²΄μ μΌλ΅ μΆ…λ£ν•λ„λ΅ μμ •**

```javascript
if (existingSocket && existingSocket.connected) {
  console.log(`β οΈ κ°™μ€ μ΄λ¦„μ ν΄λΌμ΄μ–ΈνΈ(${existingClient.name})κ°€ μ΄λ―Έ μ¨λΌμΈ μƒνƒμ…λ‹λ‹¤. μ—°κ²°μ„ μ¤‘λ³µμΌλ΅ ν—μ©ν•μ§€ μ•μµλ‹λ‹¤.`);
  socket.emit('registration_failed', { reason: 'μ΄λ―Έ μ¨λΌμΈ μƒνƒμΈ ν΄λΌμ΄μ–ΈνΈκ°€ μμµλ‹λ‹¤.' });
  
  // μ†μΌ“μ„ ν•΄μ ν•μ§€ μ•κ³  ν΄λΌμ΄μ–ΈνΈκ°€ μμ²΄μ μΌλ΅ μΆ…λ£ν•λ„λ΅ ν•¨
  console.log(`β… μ¤‘λ³µ μ—°κ²° κ±°λ¶€ - ν΄λΌμ΄μ–ΈνΈ μμ²΄ μΆ…λ£ λ€κΈ°: ${name}`);
  return;
}
```

## 4. ν•΄κ²° κ²°κ³Ό

### 4.1 μ„±κ³µμ μΈ λ™μ‘
1. **μ²« λ²μ§Έ ν΄λΌμ΄μ–ΈνΈ**: μ •μƒ μ‹¤ν–‰ λ° μ„λ²„ μ—°κ²°
2. **λ‘ λ²μ§Έ ν΄λΌμ΄μ–ΈνΈ**: ν”„λ΅μ„Έμ¤ ν™•μΈ μ‹ μ¦‰μ‹ μΆ…λ£
3. **μ„λ²„**: μ²« λ²μ§Έ ν΄λΌμ΄μ–ΈνΈμ™€ μ •μƒ ν†µμ‹  μ μ§€
4. **μ‹μ¤ν… μ•μ •μ„±**: μ¤‘λ³µ μ‹¤ν–‰μΌλ΅ μΈν• λ¬Έμ  μ™„μ „ ν•΄κ²°

### 4.2 λ΅κ·Έ μμ‹
```
=========================================
 Launching Switchboard Plus v2.0 Client
=========================================
π€ Starting client with computer name
To stop the client, press Ctrl+C in this window.
μ„λ²„: http://localhost:8000
β οΈ λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈ ν”„λ΅μ„Έμ¤ λ°κ²¬: PID 23824
β μ΄λ―Έ μ‹¤ν–‰ μ¤‘μΈ ν΄λΌμ΄μ–ΈνΈκ°€ μμµλ‹λ‹¤. (μ΄λ¦„: motiondjHome)
2025-06-22 19:45:07,608 - ERROR - μ΄λ―Έ μ‹¤ν–‰ μ¤‘μΈ ν΄λΌμ΄μ–ΈνΈκ°€ μμµλ‹λ‹¤. (μ΄λ¦„: motiondjHome)
β… ν΄λΌμ΄μ–ΈνΈ μΆ…λ£
Client has been stopped.
Press any key to continue . . .
```

## 5. κΈ°μ μ  κ°μ„ μ‚¬ν•­

### 5.1 μ¥μ 
- β… **μ„λ²„ μ—°κ²° μ‹λ„ μ—†μ΄** λ΅μ»¬μ—μ„ μ¤‘λ³µ μ‹¤ν–‰μ„ λ°©μ§€
- β… **ν”„λ΅μ„Έμ¤ λ λ²¨μ—μ„ μ •ν™•ν• μ¤‘λ³µ κ°μ§€**
- β… **μ†μΌ“ μ¶©λ λ¬Έμ  μ™„μ „ ν•΄κ²°**
- β… **κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈμ— μ „ν€ μν–¥ μ—†μ**
- β… **λΉ λ¥Έ μ‘λ‹µ** (μ„λ²„ μ—°κ²° μ‹λ„ μ—†μ΄ μ¦‰μ‹ μΆ…λ£)

### 5.2 μ•μ „μ„±
- **μ¤λ¥ μ²λ¦¬**: ν”„λ΅μ„Έμ¤ ν™•μΈ μ¤‘ μ¤λ¥ λ°μƒ μ‹ μ‹¤ν–‰ ν—μ©
- **μμ™Έ μ²λ¦¬**: psutil κ΄€λ ¨ μμ™Έ μƒν™© μ²λ¦¬
- **λ΅κΉ…**: μƒμ„Έν• λ΅κ·Έλ΅ λ¬Έμ  μ¶”μ  κ°€λ¥

## 6. κ²°λ΅ 

**μ¤‘λ³µ ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰ λ°©μ§€ κΈ°λ¥**μ΄ μ„±κ³µμ μΌλ΅ κµ¬ν„λμ—μµλ‹λ‹¤. 

**ν•µμ‹¬ ν•΄κ²°μ±…**:
1. **ν”„λ΅μ„Έμ¤ κΈ°λ° μ¤‘λ³µ κ°μ§€**: psutil λΌμ΄λΈλ¬λ¦¬λ¥Ό ν™μ©ν• μ •ν™•ν• ν”„λ΅μ„Έμ¤ ν™•μΈ
2. **λ΅μ»¬ λ λ²¨μ—μ„μ μ°¨λ‹¨**: μ„λ²„ μ—°κ²° μ‹λ„ μ—†μ΄ ν΄λΌμ΄μ–ΈνΈ λ λ²¨μ—μ„ μ°¨λ‹¨
3. **μ„λ²„ μΈ΅ κ°μ„ **: μ¤‘λ³µ μ—°κ²° κ±°λ¶€ μ‹ μ†μΌ“ ν•΄μ ν•μ§€ μ•μ

**κ²°κ³Ό**: κ°™μ€ μ»΄ν“¨ν„°μ—μ„ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰ν•λ ¤κ³  ν•΄λ„ μ•μ „ν•κ² λ°©μ§€λλ©°, κΈ°μ΅΄ ν΄λΌμ΄μ–ΈνΈμ μ•μ •μ μΈ λ™μ‘μ΄ λ³΄μ¥λ©λ‹λ‹¤.

---

**μ‘μ„±μΌ**: 2025-06-22  
**λ²„μ „**: v2.0  
**μƒνƒ**: μ™„λ£ β… 